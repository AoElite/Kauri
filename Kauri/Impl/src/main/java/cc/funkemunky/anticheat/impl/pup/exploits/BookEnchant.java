package cc.funkemunky.anticheat.impl.pup.exploits;

import cc.funkemunky.anticheat.api.pup.AntiPUP;
import cc.funkemunky.anticheat.api.pup.PuPType;
import org.bukkit.GameMode;
import org.bukkit.Material;
import org.bukkit.event.EventHandler;
import org.bukkit.event.enchantment.PrepareItemEnchantEvent;
import org.bukkit.event.player.PlayerInteractEvent;

public class BookEnchant extends AntiPUP {
    public BookEnchant(String name, PuPType type, boolean enabled) {
        super(name, type, enabled);
    }

    @Override
    public boolean onPacket(Object packet, String packetType, long timeStamp) {
        return false;
    }

    @EventHandler
    public void onEnchant(PrepareItemEnchantEvent event) {
        if (event.getItem().getType().equals(Material.BOOK)) {
            event.setCancelled(true);
        }
    }

    @EventHandler
    public void onEvent(PlayerInteractEvent event) {
        if (!event.getPlayer().isOp()
                && !event.getPlayer().getGameMode().equals(GameMode.CREATIVE)
                && event.getItem() != null
                && event.getItem().getType().equals(Material.BOOK) && event.getItem().getEnchantments().size() > 0) {
            event.getItem().getEnchantments().clear();
        }
    }
}
